<!doctype html>
<html>

<head>
  <title>Collaborative editing with CodeMirror</title>
  <link rel="stylesheet" href="codemirror/lib/codemirror.css" />
  <style>
    * { margin: 0; padding: 0; }

    body {
      font: 16px Helvetica, Arial, sans-serif;
    }

    #wrapper {
      width: 960px;
      margin: 0 auto;
    }

    h1 {
      font-size: 48px; line-height: 64px;
      margin: 8px 0;
    }
  </style>
</head>

<body>
  <div id="wrapper">
    <h1>Collaborative editing with CodeMirror</h1>
<textarea id="code">
for (var i = 0; i &lt; 1000; i++) {
  foo(i);
  console.log("lorem");
}
</textarea>
  </div>

  <script src="codemirror/lib/codemirror.js"></script>
  <script src="codemirror/mode/javascript/javascript.js"></script>
  <script src="../../lib/operational-transformation.js"></script>
  <script src="codemirror-operational-transformation.js"></script>

  <script>
    (function () {
      var textarea = document.getElementById('code');
      var cm = CodeMirror.fromTextArea(textarea, {
        lineNumbers: true,
        mode: 'javascript',
        onChange: function (cm, change) {
          var operation = codeMirrorChangeToOperation(cm, change, oldValue);
          console.log(change, operation);
          oldValue = cm.getValue();
        }
      });
      var oldValue = cm.getValue();
    })();
  </script>
</body>

</html>